<!-- templates/dashboard.html -->

{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2>Welcome, {{ user.username }}!</h2>

    <!-- User Profile Information -->
    <div class="profile-info mt-4">
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Admin:</strong> {{ 'Yes' if user.is_admin else 'No' }}</p>
    </div>

    <!-- User Files Section -->
    <div class="user-files mt-4">
        <h3>Your Files</h3>
        {% if user.files|length > 0 %}
            <ul class="list-group">
                {% for file in user.files %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <a href="{{ url_for('file.download_file', file_id=file.id) }}">{{ file.filename }}</a>
                        <span class="badge bg-primary">{{ file.upload_date.strftime('%Y-%m-%d') }}</span>
                        <form action="{{ url_for('file.delete_file', file_id=file.id) }}" method="POST" style="display:inline;">
                            {{ delete_form.hidden_tag() }}
                            {{ delete_form.submit(class="btn btn-danger btn-sm", onclick="return confirm('Are you sure you want to delete this file?');") }}
                        </form>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>You have not uploaded any files yet.</p>
        {% endif %}

        <!-- Link to Upload Files -->
        <a href="{{ url_for('file.upload_file') }}" class="btn btn-success mt-3">Upload New File</a>
    </div>

    <!-- Activity Logs Section -->
    <div class="activity-logs mt-5">
        <h3>Your Activity</h3>
        {% if user.activity_logs|length > 0 %}
            <ul class="list-group">
                {% for log in user.activity_logs %}
                    <li class="list-group-item">
                        {{ log.activity }} on {{ log.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No recent activities.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
